<!DOCTYPE html>
<html lang="zh-TW">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ç…é¤…ä¿  - CSSå‹•ç•«æ€§èƒ½æ¸¬è©¦</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
            color: #333;
            line-height: 1.6;
        }

        .container {
            max-width: 1400px;
            margin: 0 auto;
            padding: 20px;
        }

        .header {
            text-align: center;
            margin-bottom: 30px;
            padding: 30px;
            background: linear-gradient(135deg, #4caf50, #2196f3);
            border-radius: 20px;
            color: white;
            box-shadow: 0 8px 32px rgba(0,0,0,0.2);
        }

        .header h1 {
            font-size: 2.5rem;
            margin-bottom: 10px;
            text-shadow: 2px 2px 4px rgba(0,0,0,0.3);
        }

        .header p {
            font-size: 1.1rem;
            opacity: 0.9;
        }

        .control-panel {
            background: white;
            border-radius: 16px;
            padding: 20px;
            margin-bottom: 30px;
            box-shadow: 0 4px 16px rgba(0,0,0,0.1);
        }

        .control-panel h3 {
            color: #2196f3;
            margin-bottom: 15px;
        }

        .control-buttons {
            display: flex;
            gap: 10px;
            flex-wrap: wrap;
            margin-bottom: 15px;
        }

        .btn {
            background: #2196f3;
            color: white;
            border: none;
            padding: 12px 20px;
            border-radius: 8px;
            cursor: pointer;
            font-size: 0.9rem;
            font-weight: 600;
            transition: all 0.3s ease;
            display: flex;
            align-items: center;
            gap: 8px;
        }

        .btn:hover {
            background: #1976d2;
            transform: translateY(-2px);
            box-shadow: 0 4px 12px rgba(33, 150, 243, 0.3);
        }

        .btn:disabled {
            opacity: 0.6;
            cursor: not-allowed;
            transform: none;
        }

        .btn-primary {
            background: #4caf50;
        }

        .btn-primary:hover {
            background: #388e3c;
        }

        .btn-danger {
            background: #f44336;
        }

        .btn-danger:hover {
            background: #d32f2f;
        }

        .device-info {
            background: white;
            border-radius: 16px;
            padding: 20px;
            margin-bottom: 30px;
            box-shadow: 0 4px 16px rgba(0,0,0,0.1);
        }

        .device-info h3 {
            color: #2196f3;
            margin-bottom: 15px;
        }

        .info-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 15px;
        }

        .info-item {
            padding: 10px;
            border-left: 4px solid #2196f3;
            background: rgba(33, 150, 243, 0.05);
            border-radius: 0 8px 8px 0;
        }

        .test-area {
            background: white;
            border-radius: 16px;
            padding: 20px;
            margin-bottom: 30px;
            box-shadow: 0 4px 16px rgba(0,0,0,0.1);
            min-height: 200px;
            position: relative;
        }

        .test-area h3 {
            color: #2196f3;
            margin-bottom: 15px;
        }

        .animation-showcase {
            display: flex;
            flex-wrap: wrap;
            gap: 20px;
            justify-content: center;
            align-items: center;
            min-height: 150px;
        }

        .test-element {
            width: 80px;
            height: 80px;
            border-radius: 12px;
            display: flex;
            align-items: center;
            justify-content: center;
            color: white;
            font-weight: bold;
            font-size: 0.8rem;
            text-align: center;
            opacity: 0;
            transition: opacity 0.3s ease;
        }

        .test-element.active {
            opacity: 1;
        }

        .progress-element {
            background: linear-gradient(45deg, #2196f3, #21cbf3);
        }

        .spinner-element {
            background: linear-gradient(45deg, #4caf50, #8bc34a);
            border: 4px solid rgba(255,255,255,0.3);
            border-top: 4px solid white;
            border-radius: 50%;
        }

        .button-element {
            background: linear-gradient(45deg, #ff9800, #ffb74d);
            transition: all 0.3s ease;
        }

        .fade-element {
            background: linear-gradient(45deg, #9c27b0, #ba68c8);
        }

        .pulse-element {
            background: linear-gradient(45deg, #e91e63, #f06292);
        }

        .scale-element {
            background: linear-gradient(45deg, #00bcd4, #4dd0e1);
        }

        .slide-element {
            background: linear-gradient(45deg, #ff5722, #ff8a65);
        }

        .rotate-element {
            background: linear-gradient(45deg, #795548, #a1887f);
        }

        /* å‹•ç•«é¡ */
        .spin-animation {
            animation: spin 1s linear infinite;
        }

        .fade-animation {
            animation: fadeInOut 1s ease-in-out infinite alternate;
        }

        .pulse-animation {
            animation: pulse 1.5s ease-in-out infinite;
        }

        .scale-animation {
            animation: scaleTest 1s ease-in-out infinite alternate;
        }

        .slide-animation {
            animation: slideTest 2s ease-in-out infinite alternate;
        }

        .rotate-animation {
            animation: rotate 2s linear infinite;
        }

        .button-hover {
            transform: scale(1.1);
            box-shadow: 0 4px 16px rgba(0,0,0,0.3);
        }

        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }

        @keyframes fadeInOut {
            0% { opacity: 0.3; }
            100% { opacity: 1; }
        }

        @keyframes pulse {
            0% { transform: scale(1); opacity: 1; }
            50% { transform: scale(1.2); opacity: 0.7; }
            100% { transform: scale(1); opacity: 1; }
        }

        @keyframes scaleTest {
            0% { transform: scale(0.8); }
            100% { transform: scale(1.2); }
        }

        @keyframes slideTest {
            0% { transform: translateX(-30px); }
            50% { transform: translateX(30px); }
            100% { transform: translateX(0px); }
        }

        @keyframes rotate {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }

        .progress-bar {
            width: 100%;
            height: 8px;
            background: #e0e0e0;
            border-radius: 4px;
            margin: 10px 0;
            overflow: hidden;
        }

        .progress-fill {
            height: 100%;
            background: linear-gradient(90deg, #2196f3, #21cbf3);
            border-radius: 4px;
            width: 0%;
            transition: width 0.3s ease;
        }

        .results-panel {
            background: white;
            border-radius: 16px;
            padding: 20px;
            margin-bottom: 30px;
            box-shadow: 0 4px 16px rgba(0,0,0,0.1);
        }

        .results-panel h3 {
            color: #2196f3;
            margin-bottom: 15px;
        }

        .results-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
            gap: 20px;
            margin-bottom: 20px;
        }

        .result-card {
            border: 1px solid #e0e0e0;
            border-radius: 12px;
            padding: 15px;
            background: rgba(33, 150, 243, 0.02);
            transition: all 0.3s ease;
        }

        .result-card:hover {
            transform: translateY(-2px);
            box-shadow: 0 4px 16px rgba(0,0,0,0.1);
        }

        .result-card h4 {
            color: #333;
            margin-bottom: 10px;
            display: flex;
            align-items: center;
            gap: 8px;
        }

        .grade-badge {
            padding: 4px 12px;
            border-radius: 16px;
            font-size: 0.8rem;
            font-weight: bold;
            color: white;
        }

        .grade-a { background: #4caf50; }
        .grade-b { background: #2196f3; }
        .grade-c { background: #ff9800; }
        .grade-d, .grade-f { background: #f44336; }

        .metrics-table {
            width: 100%;
            border-collapse: collapse;
            margin: 10px 0;
            font-size: 0.9rem;
        }

        .metrics-table th,
        .metrics-table td {
            padding: 6px 10px;
            text-align: left;
            border-bottom: 1px solid #e0e0e0;
        }

        .metrics-table th {
            background: #f5f5f5;
            font-weight: 600;
            color: #333;
        }

        .metrics-table .good { color: #4caf50; font-weight: 600; }
        .metrics-table .bad { color: #f44336; font-weight: 600; }
        .metrics-table .warning { color: #ff9800; font-weight: 600; }

        .issues-list {
            list-style: none;
            padding: 0;
            margin: 10px 0;
        }

        .issues-list li {
            padding: 5px 0;
            display: flex;
            align-items: center;
            gap: 8px;
        }

        .issues-list .issue-icon {
            width: 16px;
            height: 16px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 0.7rem;
            color: white;
        }

        .issues-list .warning { background: #ff9800; }
        .issues-list .error { background: #f44336; }
        .issues-list .success { background: #4caf50; }

        .performance-monitor {
            position: fixed;
            top: 20px;
            right: 20px;
            background: rgba(0,0,0,0.8);
            color: white;
            padding: 10px 15px;
            border-radius: 8px;
            font-family: monospace;
            font-size: 0.8rem;
            z-index: 1000;
            opacity: 0;
            transition: opacity 0.3s ease;
        }

        .performance-monitor.active {
            opacity: 1;
        }

        .performance-monitor div {
            margin: 2px 0;
        }

        .loading-overlay {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(255,255,255,0.9);
            display: none;
            align-items: center;
            justify-content: center;
            z-index: 2000;
        }

        .loading-overlay.active {
            display: flex;
        }

        .loading-spinner {
            width: 60px;
            height: 60px;
            border: 6px solid #e0e0e0;
            border-top: 6px solid #2196f3;
            border-radius: 50%;
            animation: spin 1s linear infinite;
        }

        @media (max-width: 768px) {
            .container {
                padding: 10px;
            }
            
            .header h1 {
                font-size: 2rem;
            }
            
            .control-buttons {
                flex-direction: column;
            }
            
            .info-grid,
            .results-grid {
                grid-template-columns: 1fr;
            }
            
            .animation-showcase {
                gap: 15px;
            }
            
            .test-element {
                width: 60px;
                height: 60px;
                font-size: 0.7rem;
            }
            
            .performance-monitor {
                position: static;
                margin: 10px 0;
            }
        }

        @media (prefers-reduced-motion: reduce) {
            * {
                animation-duration: 0.01ms !important;
                animation-iteration-count: 1 !important;
                transition-duration: 0.01ms !important;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="header">
            <h1>ğŸ¬ CSSå‹•ç•«æ€§èƒ½æ¸¬è©¦</h1>
            <p>é©—è­‰CSSå‹•ç•«çš„æ€§èƒ½è¡¨ç¾ï¼ŒåŒ…æ‹¬é€²åº¦æ¢å‹•ç•«ã€æŒ‰éˆ•éæ¸¡æ•ˆæœã€å°è©±æ¡†å‹•ç•«ç­‰ã€‚æ¸¬è©¦å‹•ç•«åœ¨ä¸åŒè¨­å‚™ä¸Šçš„æµæš¢æ€§å’ŒCPUä½¿ç”¨ç‡ã€‚</p>
        </div>

        <!-- æ€§èƒ½ç›£æ§å™¨ -->
        <div class="performance-monitor" id="performanceMonitor">
            <div>FPS: <span id="fpsDisplay">--</span></div>
            <div>Frame Time: <span id="frameTimeDisplay">--</span>ms</div>
            <div>Memory: <span id="memoryDisplay">--</span>MB</div>
        </div>

        <!-- æ§åˆ¶é¢æ¿ -->
        <div class="control-panel">
            <h3>æ¸¬è©¦æ§åˆ¶</h3>
            <div class="control-buttons">
                <button class="btn btn-primary" onclick="runProgressTest()">é€²åº¦æ¢æ¸¬è©¦</button>
                <button class="btn btn-primary" onclick="runSpinnerTest()">æ—‹è½‰å‹•ç•«æ¸¬è©¦</button>
                <button class="btn btn-primary" onclick="runButtonTest()">æŒ‰éˆ•éæ¸¡æ¸¬è©¦</button>
                <button class="btn btn-primary" onclick="runFadeTest()">æ·¡å…¥å‹•ç•«æ¸¬è©¦</button>
                <button class="btn btn-primary" onclick="runPulseTest()">è„ˆè¡å‹•ç•«æ¸¬è©¦</button>
                <button class="btn btn-primary" onclick="runScaleTest()">ç¸®æ”¾å‹•ç•«æ¸¬è©¦</button>
                <button class="btn btn-primary" onclick="runSlideTest()">æ»‘å‹•å‹•ç•«æ¸¬è©¦</button>
                <button class="btn btn-primary" onclick="runRotateTest()">æ—‹è½‰å‹•ç•«æ¸¬è©¦</button>
            </div>
            <div class="control-buttons">
                <button class="btn" onclick="runAllTests()">ğŸ§ª é‹è¡Œæ‰€æœ‰æ¸¬è©¦</button>
                <button class="btn" onclick="stopAllTests()">â¹ï¸ åœæ­¢æ¸¬è©¦</button>
                <button class="btn" onclick="clearResults()">ğŸ—‘ï¸ æ¸…é™¤çµæœ</button>
                <button class="btn" onclick="exportResults()">ğŸ“‹ å°å‡ºçµæœ</button>
            </div>
            
            <div class="progress-bar">
                <div class="progress-fill" id="testProgress"></div>
            </div>
        </div>

        <!-- è¨­å‚™ä¿¡æ¯ -->
        <div class="device-info">
            <h3>ğŸ“± è¨­å‚™ä¿¡æ¯</h3>
            <div class="info-grid" id="deviceInfo">
                <!-- è¨­å‚™ä¿¡æ¯å°‡åœ¨é€™è£¡å‹•æ…‹é¡¯ç¤º -->
            </div>
        </div>

        <!-- å‹•ç•«æ¸¬è©¦å€åŸŸ -->
        <div class="test-area">
            <h3>ğŸ¯ å‹•ç•«å±•ç¤ºå€åŸŸ</h3>
            <div class="animation-showcase">
                <div class="test-element progress-element" id="progressElement">
                    é€²åº¦
                </div>
                <div class="test-element spinner-element" id="spinnerElement">
                    è¼‰å…¥
                </div>
                <div class="test-element button-element" id="buttonElement">
                    æŒ‰éˆ•
                </div>
                <div class="test-element fade-element" id="fadeElement">
                    æ·¡å…¥
                </div>
                <div class="test-element pulse-element" id="pulseElement">
                    è„ˆè¡
                </div>
                <div class="test-element scale-element" id="scaleElement">
                    ç¸®æ”¾
                </div>
                <div class="test-element slide-element" id="slideElement">
                    æ»‘å‹•
                </div>
                <div class="test-element rotate-element" id="rotateElement">
                    æ—‹è½‰
                </div>
            </div>
        </div>

        <!-- æ¸¬è©¦çµæœ -->
        <div class="results-panel">
            <h3>ğŸ“Š æ¸¬è©¦çµæœ</h3>
            <div class="results-grid" id="resultsGrid">
                <div style="text-align: center; color: #666; grid-column: 1 / -1; padding: 40px;">
                    é‚„æ²’æœ‰æ¸¬è©¦çµæœï¼Œè«‹é‹è¡Œå‹•ç•«æ€§èƒ½æ¸¬è©¦
                </div>
            </div>
        </div>
    </div>

    <!-- è¼‰å…¥é®ç½© -->
    <div class="loading-overlay" id="loadingOverlay">
        <div>
            <div class="loading-spinner"></div>
            <div style="text-align: center; margin-top: 20px; font-weight: 600;">
                <span id="loadingText">æ¸¬è©¦é€²è¡Œä¸­...</span>
            </div>
        </div>
    </div>

    <script>
        // å‹•ç•«æ€§èƒ½æ¸¬è©¦å™¨
        class AnimationPerformanceTester {
            constructor() {
                this.isRunning = false;
                this.currentTest = null;
                this.results = [];
                this.rafId = null;
                this.startTime = 0;
                this.frameCount = 0;
                this.frameTimes = [];
                this.lastFrameTime = 0;
                
                this.initDeviceInfo();
                this.startPerformanceMonitoring();
            }
            
            initDeviceInfo() {
                const deviceInfo = this.getDeviceInfo();
                const container = document.getElementById('deviceInfo');
                
                container.innerHTML = `
                    <div class="info-item">
                        <strong>å¹³å°:</strong> ${deviceInfo.platform}
                    </div>
                    <div class="info-item">
                        <strong>CPUæ ¸å¿ƒ:</strong> ${deviceInfo.cores}
                    </div>
                    <div class="info-item">
                        <strong>å…§å­˜:</strong> ${deviceInfo.memory}
                    </div>
                    <div class="info-item">
                        <strong>åƒç´ æ¯”:</strong> ${deviceInfo.pixelRatio}
                    </div>
                    <div class="info-item">
                        <strong>å±å¹•:</strong> ${deviceInfo.screen}
                    </div>
                    <div class="info-item">
                        <strong>è¨­å‚™é¡å‹:</strong> ${deviceInfo.deviceType}
                    </div>
                `;
            }
            
            getDeviceInfo() {
                const nav = navigator;
                const screen = window.screen;
                
                return {
                    platform: nav.platform,
                    cores: nav.hardwareConcurrency || 'æœªçŸ¥',
                    memory: nav.deviceMemory ? `${nav.deviceMemory}GB` : 'æœªçŸ¥',
                    pixelRatio: window.devicePixelRatio || 1,
                    screen: `${screen.width}x${screen.height}`,
                    deviceType: nav.hardwareConcurrency <= 2 ? 'ä½ç«¯è¨­å‚™' : 'é«˜æ€§èƒ½è¨­å‚™'
                };
            }
            
            startPerformanceMonitoring() {
                const monitor = document.getElementById('performanceMonitor');
                const fpsDisplay = document.getElementById('fpsDisplay');
                const frameTimeDisplay = document.getElementById('frameTimeDisplay');
                const memoryDisplay = document.getElementById('memoryDisplay');
                
                let lastTime = performance.now();
                let frameCount = 0;
                let fps = 0;
                
                const updateMonitor = (currentTime) => {
                    frameCount++;
                    const deltaTime = currentTime - lastTime;
                    
                    if (deltaTime >= 1000) {
                        fps = Math.round((frameCount * 1000) / deltaTime);
                        fpsDisplay.textContent = fps;
                        frameTimeDisplay.textContent = (1000 / fps).toFixed(2);
                        
                        // æ›´æ–°å…§å­˜ä¿¡æ¯
                        if (performance.memory) {
                            const memory = Math.round(performance.memory.usedJSHeapSize / 1024 / 1024);
                            memoryDisplay.textContent = memory;
                        }
                        
                        lastTime = currentTime;
                        frameCount = 0;
                    }
                    
                    if (this.isRunning) {
                        monitor.classList.add('active');
                    } else {
                        monitor.classList.remove('active');
                    }
                    
                    requestAnimationFrame(updateMonitor);
                };
                
                requestAnimationFrame(updateMonitor);
            }
            
            async runTest(name, element, animationClass, duration = 5000) {
                return new Promise((resolve) => {
                    this.isRunning = true;
                    this.currentTest = name;
                    this.frameCount = 0;
                    this.frameTimes = [];
                    this.startTime = performance.now();
                    
                    // é¡¯ç¤ºè¼‰å…¥é®ç½©
                    const loadingOverlay = document.getElementById('loadingOverlay');
                    const loadingText = document.getElementById('loadingText');
                    loadingOverlay.classList.add('active');
                    loadingText.textContent = `æ¸¬è©¦ä¸­: ${name}`;
                    
                    // å•Ÿå‹•å‹•ç•«
                    element.classList.add('active');
                    if (animationClass) {
                        element.classList.add(animationClass);
                    }
                    
                    // é–‹å§‹å¹€ç‡æ¸¬é‡
                    let lastFrameTime = performance.now();
                    
                    const measureFrame = (currentTime) => {
                        const frameTime = currentTime - lastFrameTime;
                        this.frameTimes.push(frameTime);
                        lastFrameTime = currentTime;
                        this.frameCount++;
                        
                        if (this.isRunning && performance.now() - this.startTime < duration) {
                            requestAnimationFrame(measureFrame);
                        } else {
                            this.finishTest(name, element, animationClass, resolve);
                        }
                    };
                    
                    requestAnimationFrame(measureFrame);
                });
            }
            
            finishTest(name, element, animationClass, resolve) {
                this.isRunning = false;
                
                // åœæ­¢å‹•ç•«
                element.classList.remove('active');
                if (animationClass) {
                    element.classList.remove(animationClass);
                }
                
                // éš±è—è¼‰å…¥é®ç½©
                document.getElementById('loadingOverlay').classList.remove('active');
                
                // è¨ˆç®—æ€§èƒ½æŒ‡æ¨™
                const testDuration = performance.now() - this.startTime;
                const metrics = this.calculateMetrics(testDuration);
                const grade = this.calculateGrade(metrics);
                const issues = this.analyzeIssues(metrics);
                
                const result = {
                    name,
                    metrics,
                    grade,
                    issues,
                    timestamp: new Date().toLocaleString('zh-TW')
                };
                
                this.results.push(result);
                this.displayResult(result);
                
                resolve(result);
            }
            
            calculateMetrics(testDuration) {
                const totalFrames = this.frameTimes.length;
                const avgFrameTime = this.frameTimes.reduce((a, b) => a + b, 0) / totalFrames;
                const fps = totalFrames > 0 ? 1000 / avgFrameTime : 0;
                const minFrameTime = Math.min(...this.frameTimes);
                const maxFrameTime = Math.max(...this.frameTimes);
                const jankFrames = this.frameTimes.filter(time => time > 16.67).length;
                
                let memoryUsage = null;
                if (performance.memory) {
                    memoryUsage = Math.round(performance.memory.usedJSHeapSize / 1024 / 1024);
                }
                
                return {
                    fps: Math.round(fps * 100) / 100,
                    avgFrameTime: Math.round(avgFrameTime * 100) / 100,
                    minFrameTime: Math.round(minFrameTime * 100) / 100,
                    maxFrameTime: Math.round(maxFrameTime * 100) / 100,
                    totalFrames,
                    jankFrames,
                    memoryUsage,
                    duration: Math.round(testDuration)
                };
            }
            
            calculateGrade(metrics) {
                const fpsRatio = metrics.fps / 60;
                const jankRatio = metrics.jankFrames / metrics.totalFrames;
                
                if (fpsRatio >= 0.95 && jankRatio <= 0.05) return 'A';
                if (fpsRatio >= 0.85 && jankRatio <= 0.10) return 'B';
                if (fpsRatio >= 0.70 && jankRatio <= 0.20) return 'C';
                if (fpsRatio >= 0.50 && jankRatio <= 0.35) return 'D';
                return 'F';
            }
            
            analyzeIssues(metrics) {
                const issues = [];
                
                if (metrics.fps < 30) {
                    issues.push({ type: 'error', message: 'å¹€ç‡éä½ï¼Œå‹•ç•«ä¸æµæš¢' });
                }
                
                if (metrics.jankFrames / metrics.totalFrames > 0.1) {
                    issues.push({ type: 'warning', message: 'å¡é “å¹€éå¤šï¼Œç”¨æˆ¶é«”é©—è¼ƒå·®' });
                }
                
                if (metrics.maxFrameTime > 100) {
                    issues.push({ type: 'warning', message: 'å­˜åœ¨æ¥µé•·çš„å¹€æ™‚é–“' });
                }
                
                if (metrics.fps >= 55) {
                    issues.push({ type: 'success', message: 'å‹•ç•«æ€§èƒ½è‰¯å¥½' });
                }
                
                return issues;
            }
            
            displayResult(result) {
                const resultsGrid = document.getElementById('resultsGrid');
                
                if (resultsGrid.children.length === 1 && resultsGrid.children[0].textContent.includes('é‚„æ²’æœ‰')) {
                    resultsGrid.innerHTML = '';
                }
                
                const resultCard = document.createElement('div');
                resultCard.className = 'result-card';
                
                const issuesHtml = result.issues.map(issue => 
                    `<li><span class="issue-icon ${issue.type}">${issue.type === 'success' ? 'âœ“' : issue.type === 'warning' ? '!' : 'âœ—'}</span>${issue.message}</li>`
                ).join('');
                
                resultCard.innerHTML = `
                    <h4>
                        ${result.name}
                        <span class="grade-badge grade-${result.grade.toLowerCase()}">${result.grade}</span>
                    </h4>
                    <table class="metrics-table">
                        <tr>
                            <td>FPS</td>
                            <td class="${result.metrics.fps >= 50 ? 'good' : result.metrics.fps >= 30 ? 'warning' : 'bad'}">${result.metrics.fps}</td>
                        </tr>
                        <tr>
                            <td>å¹³å‡å¹€æ™‚é–“</td>
                            <td>${result.metrics.avgFrameTime}ms</td>
                        </tr>
                        <tr>
                            <td>å¡é “å¹€æ•¸</td>
                            <td class="${result.metrics.jankFrames < 5 ? 'good' : result.metrics.jankFrames < 20 ? 'warning' : 'bad'}">${result.metrics.jankFrames}</td>
                        </tr>
                        ${result.metrics.memoryUsage ? `<tr><td>å…§å­˜ä½¿ç”¨</td><td>${result.metrics.memoryUsage}MB</td></tr>` : ''}
                    </table>
                    ${result.issues.length > 0 ? `<ul class="issues-list">${issuesHtml}</ul>` : ''}
                    <small style="color: #666;">æ¸¬è©¦æ™‚é–“: ${result.timestamp}</small>
                `;
                
                resultsGrid.appendChild(resultCard);
            }
            
            stop() {
                this.isRunning = false;
                if (this.rafId) {
                    cancelAnimationFrame(this.rafId);
                }
                
                // æ¸…ç†æ‰€æœ‰å‹•ç•«
                document.querySelectorAll('.test-element').forEach(element => {
                    element.classList.remove('active');
                    element.className = element.className.replace(/\s*\w*-animation/g, '');
                });
                
                document.getElementById('loadingOverlay').classList.remove('active');
            }
        }
        
        // å…¨å±€æ¸¬è©¦å™¨å¯¦ä¾‹
        let tester = new AnimationPerformanceTester();
        
        // æ¸¬è©¦å‡½æ•¸
        async function runProgressTest() {
            const element = document.getElementById('progressElement');
            await tester.runTest('åœ“å½¢é€²åº¦æ¢å‹•ç•«', element, null, 4000);
        }
        
        async function runSpinnerTest() {
            const element = document.getElementById('spinnerElement');
            await tester.runTest('æ—‹è½‰è¼‰å…¥å‹•ç•«', element, 'spin-animation', 4000);
        }
        
        async function runButtonTest() {
            const element = document.getElementById('buttonElement');
            // æ¨¡æ“¬hoveræ•ˆæœ
            const simulateHover = () => {
                if (tester.isRunning) {
                    element.classList.toggle('button-hover');
                    setTimeout(simulateHover, 200);
                }
            };
            setTimeout(simulateHover, 100);
            await tester.runTest('æŒ‰éˆ•éæ¸¡æ•ˆæœ', element, null, 3000);
        }
        
        async function runFadeTest() {
            const element = document.getElementById('fadeElement');
            await tester.runTest('æ·¡å…¥å‹•ç•«', element, 'fade-animation', 3000);
        }
        
        async function runPulseTest() {
            const element = document.getElementById('pulseElement');
            await tester.runTest('è„ˆè¡å‹•ç•«', element, 'pulse-animation', 4000);
        }
        
        async function runScaleTest() {
            const element = document.getElementById('scaleElement');
            await tester.runTest('ç¸®æ”¾å‹•ç•«', element, 'scale-animation', 3000);
        }
        
        async function runSlideTest() {
            const element = document.getElementById('slideElement');
            await tester.runTest('æ»‘å‹•å‹•ç•«', element, 'slide-animation', 4000);
        }
        
        async function runRotateTest() {
            const element = document.getElementById('rotateElement');
            await tester.runTest('æ—‹è½‰å‹•ç•«', element, 'rotate-animation', 3000);
        }
        
        async function runAllTests() {
            const tests = [
                runProgressTest,
                runSpinnerTest,
                runButtonTest,
                runFadeTest,
                runPulseTest,
                runScaleTest,
                runSlideTest,
                runRotateTest
            ];
            
            const progressBar = document.getElementById('testProgress');
            
            for (let i = 0; i < tests.length; i++) {
                if (!tester.isRunning && i > 0) break; // å¦‚æœè¢«åœæ­¢äº†
                
                const progress = ((i + 1) / tests.length) * 100;
                progressBar.style.width = `${progress}%`;
                
                await tests[i]();
                await new Promise(resolve => setTimeout(resolve, 1000)); // æ¸¬è©¦é–“éš”
            }
            
            progressBar.style.width = '0%';
        }
        
        function stopAllTests() {
            tester.stop();
            document.getElementById('testProgress').style.width = '0%';
        }
        
        function clearResults() {
            tester.results = [];
            const resultsGrid = document.getElementById('resultsGrid');
            resultsGrid.innerHTML = `
                <div style="text-align: center; color: #666; grid-column: 1 / -1; padding: 40px;">
                    é‚„æ²’æœ‰æ¸¬è©¦çµæœï¼Œè«‹é‹è¡Œå‹•ç•«æ€§èƒ½æ¸¬è©¦
                </div>
            `;
        }
        
        function exportResults() {
            if (tester.results.length === 0) {
                alert('æ²’æœ‰æ¸¬è©¦çµæœå¯ä»¥å°å‡º');
                return;
            }
            
            const report = generateReport(tester.results);
            const blob = new Blob([report], { type: 'text/markdown' });
            const url = URL.createObjectURL(blob);
            const a = document.createElement('a');
            a.href = url;
            a.download = `animation-performance-report-${new Date().toISOString().split('T')[0]}.md`;
            document.body.appendChild(a);
            a.click();
            document.body.removeChild(a);
            URL.revokeObjectURL(url);
        }
        
        function generateReport(results) {
            const deviceInfo = tester.getDeviceInfo();
            const timestamp = new Date().toLocaleString('zh-TW');
            
            let report = `# CSSå‹•ç•«æ€§èƒ½æ¸¬è©¦å ±å‘Š\n\n`;
            report += `**æ¸¬è©¦æ™‚é–“**: ${timestamp}\n\n`;
            
            report += `## è¨­å‚™ä¿¡æ¯\n`;
            report += `- **å¹³å°**: ${deviceInfo.platform}\n`;
            report += `- **CPUæ ¸å¿ƒ**: ${deviceInfo.cores}\n`;
            report += `- **å…§å­˜**: ${deviceInfo.memory}\n`;
            report += `- **åƒç´ æ¯”**: ${deviceInfo.pixelRatio}\n`;
            report += `- **å±å¹•å°ºå¯¸**: ${deviceInfo.screen}\n`;
            report += `- **è¨­å‚™é¡å‹**: ${deviceInfo.deviceType}\n\n`;
            
            report += `## æ¸¬è©¦çµæœ\n\n`;
            
            results.forEach(result => {
                report += `### ${result.name}\n`;
                report += `- **ç­‰ç´š**: ${result.grade}\n`;
                report += `- **FPS**: ${result.metrics.fps}\n`;
                report += `- **å¹³å‡å¹€æ™‚é–“**: ${result.metrics.avgFrameTime}ms\n`;
                report += `- **å¡é “å¹€æ•¸**: ${result.metrics.jankFrames}/${result.metrics.totalFrames}\n`;
                
                if (result.issues.length > 0) {
                    report += `- **å•é¡Œ**: ${result.issues.map(issue => issue.message).join(', ')}\n`;
                }
                
                report += `\n`;
            });
            
            return report;
        }
        
        // é é¢è¼‰å…¥å®Œæˆå¾Œçš„åˆå§‹åŒ–
        document.addEventListener('DOMContentLoaded', () => {
            console.log('CSSå‹•ç•«æ€§èƒ½æ¸¬è©¦å™¨å·²åˆå§‹åŒ–');
        });
    </script>
</body>
</html>


